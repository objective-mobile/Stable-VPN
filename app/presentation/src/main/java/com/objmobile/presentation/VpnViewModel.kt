package com.objmobile.presentation

import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import com.objmobile.domain.VpnRepository
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.flow.SharingStarted
import kotlinx.coroutines.flow.StateFlow
import kotlinx.coroutines.flow.map
import kotlinx.coroutines.flow.stateIn
import kotlinx.coroutines.launch

class VpnViewModel(private val vpnRepository: VpnRepository) : ViewModel() {
    val vpnStatus: StateFlow<VpnStatusUi> = vpnRepository.stableVpnStatus.map {
        TextStatus(it.toString())
    }.stateIn(
        viewModelScope, SharingStarted.WhileSubscribed(1000), TextStatus("")
    )

    fun connectVpn() {
        vpnRepository.connectProfile(
            "Europe",
            "# Automatically generated OpenVPN client config file\n" + "# Generated on Wed Oct  1 14:09:02 2025 by ip-10-0-2-161\n" + "# Note: this config file contains inline private keys\n" + "#       and therefore should be kept confidential!\n" + "#       Certificate serial: 8, certificate common name: user_AUTOLOGIN\n" + "#       Expires 2035-09-29 14:09:02\n" + "# Note: this configuration is user-locked to the username below\n" + "# OVPN_ACCESS_SERVER_USERNAME=user\n" + "# Define the profile name of this particular configuration file\n" + "# OVPN_ACCESS_SERVER_PROFILE=user@63.180.85.34/AUTOLOGIN\n" + "# OVPN_ACCESS_SERVER_AUTOLOGIN=1\n" + "\n" + "# Default Cipher\n" + "cipher AES-256-CBC\n" + "# OVPN_ACCESS_SERVER_CLI_PREF_ALLOW_WEB_IMPORT=True\n" + "# OVPN_ACCESS_SERVER_CLI_PREF_BASIC_CLIENT=False\n" + "# OVPN_ACCESS_SERVER_CLI_PREF_ENABLE_CONNECT=False\n" + "# OVPN_ACCESS_SERVER_CLI_PREF_ENABLE_XD_PROXY=True\n" + "# OVPN_ACCESS_SERVER_WSHOST=63.180.85.34:443\n" + "# OVPN_ACCESS_SERVER_WEB_CA_BUNDLE_START\n" + "# -----BEGIN CERTIFICATE-----\n" + "# MIIDHDCCAgSgAwIBAgIEaN0sWzANBgkqhkiG9w0BAQsFADA/MT0wOwYDVQQDDDRP\n" + "# cGVuVlBOIFdlYiBDQSAyMDI1LjEwLjAxIDEzOjI3OjU1IFVUQyBpcC0xMC0wLTIt\n" + "# MTYxMB4XDTI1MDkzMDEzMjc1NVoXDTM1MDkyOTEzMjc1NVowPzE9MDsGA1UEAww0\n" + "# T3BlblZQTiBXZWIgQ0EgMjAyNS4xMC4wMSAxMzoyNzo1NSBVVEMgaXAtMTAtMC0y\n" + "# LTE2MTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMEr6tcWf3BmYc8Q\n" + "# hDWtb52tzktV8Enabb7JlatRhR2nu+4Ad782Uq5c87rjNE/OJKDIber4NoutCXoA\n" + "# jeSwBNtIV6/badwqhKteSACXVF7m9git6oh6zFvwmO4rPH/DGWvFbLjn7hMn3am6\n" + "# +PvUrKlUJ8CDd3XKC3Cf1GRaqHsCZMIxTK/ILJkibHZt6qYxIIzrVU/5jYRzMI65\n" + "# DVzM95EvANaRaK89bs7CFsgIlP26ElIo21RhS12Ogkch+aXsa09WlBATV+pX9T7i\n" + "# pmaO+RbHWdNdJhpAqF0xwWWa7BOkJLruiCpYA706HmcwDMhc9JpTCbFnpW20FQVq\n" + "# DqECOOUCAwEAAaMgMB4wDwYDVR0TAQH/BAUwAwEB/zALBgNVHQ8EBAMCAQYwDQYJ\n" + "# KoZIhvcNAQELBQADggEBAB1ucsL+0g+tK6odvAPuVbPPuPlLWYWR1V/HlnGn6K0N\n" + "# Db4ri5p57tYbW+4zT2F8LkIKt/fmVKZfIJoKt4octEGUPzDLyEB654cli2iW4G8O\n" + "# b6UVGZbObjAqGLHXK39/ovSPYlxI3gff7919iU+kq+tm1NAu3Oq3yXCd/iJAVqel\n" + "# mrEIAkGsS4Yq6XVvv+nhWpxf/H6QV5TWwp408h47mr7/o/Mum3pDiy93HSHBauf3\n" + "# gcD2rKwSGcrygQH4xHRGFjNUa1wG3/axX4SLy5McfaunkqICw5k0/IoA25/M4QOW\n" + "# 1a+zXnChn94/8O/Zzag1eBYtP8Jf4F/2bAqplHlVGCc=\n" + "# -----END CERTIFICATE-----\n" + "# OVPN_ACCESS_SERVER_WEB_CA_BUNDLE_STOP\n" + "# OVPN_ACCESS_SERVER_IS_OPENVPN_WEB_CA=1\n" + "client\n" + "server-poll-timeout 4\n" + "nobind\n" + "remote 63.180.85.34 1194 udp\n" + "remote 63.180.85.34 1194 udp\n" + "remote 63.180.85.34 443 tcp\n" + "remote 63.180.85.34 1194 udp\n" + "remote 63.180.85.34 1194 udp\n" + "remote 63.180.85.34 1194 udp\n" + "remote 63.180.85.34 1194 udp\n" + "remote 63.180.85.34 1194 udp\n" + "dev tun\n" + "dev-type tun\n" + "remote-cert-tls server\n" + "tls-version-min 1.2\n" + "reneg-sec 604800\n" + "verb 3\n" + "push-peer-info\n" + "\n" + "<ca>\n" + "-----BEGIN CERTIFICATE-----\n" + "MIICyDCCAbCgAwIBAgIEaN0sVjANBgkqhkiG9w0BAQsFADAVMRMwEQYDVQQDDApP\n" + "cGVuVlBOIENBMB4XDTI1MDkzMDEzMjc1MFoXDTM1MDkyOTEzMjc1MFowFTETMBEG\n" + "A1UEAwwKT3BlblZQTiBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB\n" + "AMU4GZy+ls801MdREWktQFbzh95OvnZoAcKdxMIZiHBzGG+RGdrKpyfNymKw3w4l\n" + "MMviXBli4uKe1uHMaUiMshwjmaDz1yfzhWF3mQcvYye8NAHurcdf9dB0e2cg68oN\n" + "zejqAAI254x90eN8QfTPaDhJiYP4E9/MO/z77mqAF6GGl2ltqP1I4fYXOWC8cAO1\n" + "0EwoPLV/rLRASr9hk7h8yWTkNs7zwGBmXfqv4L4C9wMFXGX2dz30huIb2daY2IZt\n" + "DYpCVp8OaSQ+jP2SbT88c0SBZKiCvFx7O/Rnor0sVWOI5qYc7cG9LHuRr5a9VOuY\n" + "ug9e3pPQsh9AOG9NWJyBblMCAwEAAaMgMB4wDwYDVR0TAQH/BAUwAwEB/zALBgNV\n" + "HQ8EBAMCAQYwDQYJKoZIhvcNAQELBQADggEBAB1IZDULMx2iCb3YGEmTkjKWT+by\n" + "GRPVHxkfce8xOK4ZrpO/HyUBO8c4+LBWj64e1hDCMGn06NZ2IclyPuYoTktbZKnV\n" + "uWHeftsKkyBYlabFU/fPO1a+eq+oMqnLPWq9LZEH1+zNoGl/h9sB8OH5uoovNC+x\n" + "pl5yvU8Uuyn8JG/obDuc1Zsxpo6LjzlLSv8MwGl/GiXg/rk8lLeUynqRCHCNj2QH\n" + "z2rdO2afCMRezLLnW2Rfq9hZK4uBeRUxgRzydF2n8TCIHG9yoUn+G8WEkiNImfkg\n" + "bTVWhfVvQQyBTYkpfoDINBDUEs5atfm/CGKOuvLoKyhda9w9EYO8FZWfDeg=\n" + "-----END CERTIFICATE-----\n" + "</ca>\n" + "<cert>\n" + "-----BEGIN CERTIFICATE-----\n" + "MIIC7jCCAdagAwIBAgIBCDANBgkqhkiG9w0BAQsFADAVMRMwEQYDVQQDDApPcGVu\n" + "VlBOIENBMB4XDTI1MDkzMDE0MDkwMloXDTM1MDkyOTE0MDkwMlowGTEXMBUGA1UE\n" + "AwwOdXNlcl9BVVRPTE9HSU4wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIB\n" + "AQCkr8Eou7xFBRam2/LvCDc5cCm4N3fC8914fYzIojuSwHMjhvIpjokpaWXhiPvU\n" + "rJIFnVv6Dr4uJe+C2avt0eIwf/X95bmnhnm5C6JHjyN6gyd+ryEWMKgZ4pKQz3y6\n" + "GPC4FY8DMaWGIHDxHaxShMroPoHD2bkp5RLp95pzTVqAMNfLFRgfoUSA0aCZeHwX\n" + "rCyV9HT83iCIZsnqs16EXzcsoxYHexFJpHwWRABnjhdv/qA3wn8ExLoBeeQs7BQy\n" + "mcC9Nu7lSj0/7B/qaqsPju6c7BBea2EeyUVidVXzRtRoTGSZMjjRrX5yh6OLhW8T\n" + "MEGFXFveLG0NdFB52AGbhXOHAgMBAAGjRTBDMAwGA1UdEwEB/wQCMAAwCwYDVR0P\n" + "BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMCMBEGCWCGSAGG+EIBAQQEAwIHgDAN\n" + "BgkqhkiG9w0BAQsFAAOCAQEAuJfEpUbsHYjaqCIBTqcUeHz4WQSikxn4L41ekNKK\n" + "X1Ud8DyS835kySwaIJqK5n3eFFCO8f6i7p6KeLrySMR69U26P9vh8Ilx177qVGCX\n" + "aPjFuC/wmSTsEx9tGGooc37/6nFsMvJdRPTGUMmIpSDoQA/1COVZz/LKGYpVtH+j\n" + "59B2p0xUacQwEVannPtJiJhn/cUckNONSHAlVXvXP0XbAsA4vEs7bteLtQdOhP0W\n" + "OXlzAR0UkdJUAT0S+KQEkpGAPihSuRlbwxggSyhZT679Jiom8KLVqUBOiTufQUcb\n" + "XOl4WUjO9ARfl7Iea14YS8/S07oJO7cAX+bxAkxcxtR14g==\n" + "-----END CERTIFICATE-----\n" + "</cert>\n" + "<key>\n" + "-----BEGIN PRIVATE KEY-----\n" + "MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCkr8Eou7xFBRam\n" + "2/LvCDc5cCm4N3fC8914fYzIojuSwHMjhvIpjokpaWXhiPvUrJIFnVv6Dr4uJe+C\n" + "2avt0eIwf/X95bmnhnm5C6JHjyN6gyd+ryEWMKgZ4pKQz3y6GPC4FY8DMaWGIHDx\n" + "HaxShMroPoHD2bkp5RLp95pzTVqAMNfLFRgfoUSA0aCZeHwXrCyV9HT83iCIZsnq\n" + "s16EXzcsoxYHexFJpHwWRABnjhdv/qA3wn8ExLoBeeQs7BQymcC9Nu7lSj0/7B/q\n" + "aqsPju6c7BBea2EeyUVidVXzRtRoTGSZMjjRrX5yh6OLhW8TMEGFXFveLG0NdFB5\n" + "2AGbhXOHAgMBAAECggEAByoKKh54ozwEbz/UQqfF1z7U4cmv8RAwy0QS8stz8f9j\n" + "QuFk+X/U4bNPFk+iPO9A7vOYg7lOdq15zORxQUhHIbr/VYs/11TXSMCDz78fWP4J\n" + "os41j0SQm4eqvpf4IhRhrHBrp0TqoXoZz7Ntwq06Mn49oOqAzpzDhOAbnPZ5gGgN\n" + "rCaWs+k0+yItpjjhXZn93gVzgWGaTmurZm4xgR/8Ypsa/sr3Wc3Mi+Pcv2g2NWBz\n" + "jGDCEdjZQ9S4kpQh0380MoFKkc+04e3ddcM99kK2511VeofKEHZQRgYZcK05jlJ5\n" + "zy9Zv/ZAZ+ToJzsxU3eEiiadg05EzgMcuDg35JbrAQKBgQDS7ZrwoFIqsCRCWiDg\n" + "UGzg79GjqPLpBTJQn6n4TECP2fEDkdQp/Wz83xiycT/Ltbckarr0Nb8sTlTKsQPm\n" + "ShyworriJxktRvOKahiN3nHr9xcSAd+d3O0V2fDUmAfpGqKKE5SdHYRggWBnljnd\n" + "/cwg74M5rI3V0HTN0P2GhNPZgQKBgQDH4Jiyc7vZlSFPfEOfJa1t8uFmqzAdvWSe\n" + "dV2hizldurjAqtAbCgaeONaphuBVdlYgaCoShX0O2djUOgZ+N2n25dJsivwcqoO6\n" + "cIs/RKCh2AFGkTr8QNakad1b19GewCWTnap0WKlO9LeHA0WXIVj+C3aSLEBjUAqr\n" + "N1xPvGEBBwKBgA81DEeu912Wh3a1MsuZYNAy2iV3h9PfCQqhCEsbjEgSyXqdZ/OD\n" + "DvmISCqNWbEhL8wTWdlDir3yA9D9RC+1Ri5B/UFS2lDWXbasAYsw73u4u9QTiIDE\n" + "Ld+2b9OUBnX68p8L3Fobh7DBgybUwOVNaAsz2X0uAKfauKEiITUynGeBAoGANugA\n" + "qkzWlo+75czZ+pbsDF8DAiQWhKTpRgoxnVXUfWX0qKCDqFnZtY8hkNJHP9LRF/fl\n" + "Ts8yqmi3gp0p+XQZfMRnSH/pf6pro0SVS9z7T1o6B3uPu4nILMQUFc20fKqF6AYQ\n" + "tANDBzh8Te9dJ4X2n1rgyIi1a1Kqi5walKDH+PMCgYBJ+azuuV5VWi+w9Do0xM3K\n" + "OeyKtgSXKnb1zAXJpWRcgj7wDywEkxPMF+4l90EohH6fMiyq0immt55HEfwndGND\n" + "LFbAhgsJR3OZ3JlveuqwkFyeFbVJN8F7xMYt3ciJLK8bIixoXJ/3TO7TG4tiR7Eu\n" + "lUzktdPg7XQVN7k1IiQMvw==\n" + "-----END PRIVATE KEY-----\n" + "</key>\n" + "<tls-crypt>\n" + "#\n" + "# 2048 bit OpenVPN static key (Server Agent)\n" + "#\n" + "-----BEGIN OpenVPN Static key V1-----\n" + "8e11a3a48a9c2816faee41528579670d\n" + "70636d030ffaa6fb08621acae1c07cb0\n" + "9fbc31d8969e2b272f979ed4848858c3\n" + "499dacb93e64674c25d6943b80d8e7a6\n" + "840b9bdf9a63a80fb1a55e2117597f8d\n" + "4dfa6a5aed0d327c8a1fbd9548da0f8a\n" + "8cbc04089e286cc1d2e3ad22747a7e20\n" + "b8c204a4d273c95f5f02dc9e0f60154f\n" + "b5e5ab3e2795fd24492062a8fa1101f7\n" + "f07d1db4cad8c2e6c84dff8376b30d88\n" + "c49770b3dd06701a85b420a5d2c1b39a\n" + "5f5792140ef569ca58f753a282550c28\n" + "57749e8bfef6d224634b7fffe3a6f4d2\n" + "02838bfe4a8b5d25d6468b2e621e53c7\n" + "72ab68371c64da3f224755696972021a\n" + "deb9fbc9a8e19974e09afaae2109d548\n" + "-----END OpenVPN Static key V1-----\n" + "</tls-crypt>\n" + "## -----BEGIN RSA SIGNATURE-----\n" + "## DIGEST:sha256\n" + "## MEIsWJT+klAjfzifMePWml4r/3NuRQIsW5bGiHK6c+HwcMkbIn\n" + "## 6CXrUk0vGbx4PGkffJnASG/Fo5iev0W+sS28rCoVVAbb2ZbmnP\n" + "## 1d8P+loYNztKVTnEYD5xYQ1g7KR93cKZJTW0txIOg9X9NqpQom\n" + "## ujPT080H1EsQCf11++/od31QYEVsO2afvmkf2puiu0zvXLzqIV\n" + "## pnKynoEnY9WFWRFZG7v7/wjf78y6Nde6LKvGZioYhRTp+Mo3Lz\n" + "## WEsLpkMUMAyFT6FAafqe8JFfOLvOanh/kStsjhxqbabDiXX3ln\n" + "## Fk+RK/7YwoZH9FPJOWYsqcVA82guUUMS6wqmBjcV2w==\n" + "## -----END RSA SIGNATURE-----\n" + "## -----BEGIN CERTIFICATE-----\n" + "## MIIDIDCCAgigAwIBAgIFANG9LikwDQYJKoZIhvcNAQELBQAwPzE9MDsGA1UEAww0\n" + "## T3BlblZQTiBXZWIgQ0EgMjAyNS4xMC4wMSAxMzoyNzo1NSBVVEMgaXAtMTAtMC0y\n" + "## LTE2MTAeFw0yNTA5MzAxNDA4MjFaFw0yNjEwMDExNDA4MjFaMBcxFTATBgNVBAMM\n" + "## DDYzLjE4MC44NS4zNDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJe0\n" + "## vgLZKSnwvJ9JHGUcyjissmF22UslLLOgTH+DtB0DgbzbvxSiNZG45WJcbBChYlt4\n" + "## +tJRFnzwkbDuRra6kkHHYCkTycYjpGZnQIylaRfMn/k+ZMey5fSazD4YXpM5lhmL\n" + "## b8WRfhsaTQHtXO+gM8x8jPUtx5s9Hrr4aPU6I5TacjBlTIXSCfAgliTE+oXEaF9T\n" + "## GgxtUefKbAe57nkLagYKjdHjwnR0qUsNMtzWEjfr4JDGVyXscQMuryJRwaHrP21o\n" + "## YvNOz4vkV9XNif6gHmvZt3G0D9wI05947Kx1dDyBuHnua31AoJALpsCQVFKGM581\n" + "## Qg69GD5HZzlBQSy+RBECAwEAAaNLMEkwDAYDVR0TAQH/BAIwADALBgNVHQ8EBAMC\n" + "## BaAwEwYDVR0lBAwwCgYIKwYBBQUHAwEwFwYDVR0RBBAwDoIMNjMuMTgwLjg1LjM0\n" + "## MA0GCSqGSIb3DQEBCwUAA4IBAQByjr0b5eaGrDXYkySv/9yVGloYe9WAu4VDVuc3\n" + "## RcK7sByLu7q2PXc1lVPHVfVagmJypLGvIe6I6+TdyzuBXSFvQ++Mck+3Uh5IiNJQ\n" + "## +HHcWIkkVxi1NYgRzMRysXTmPqcZlyqZi8t/55CQrkwoctnvVb/QU3hez+3o7tLQ\n" + "## wzgG1pCSuBqEpXLKH2+lnHGYHHkLpWGrT31R80F/SQZ4LnbdGJRoU7VinUfdivcV\n" + "## rZ7404pcomiZyl0E/mwOsOw4oLzcgoAF85FBDjv8PkMhNuTtuAfDJCBMuYWggYG2\n" + "## y2T7WcczxvtruvLquLHTHyBZA5Ki/Xph3K35Almm6FKi4YGy\n" + "## -----END CERTIFICATE-----\n" + "## -----BEGIN CERTIFICATE-----\n" + "## MIIDHDCCAgSgAwIBAgIEaN0sWzANBgkqhkiG9w0BAQsFADA/MT0wOwYDVQQDDDRP\n" + "## cGVuVlBOIFdlYiBDQSAyMDI1LjEwLjAxIDEzOjI3OjU1IFVUQyBpcC0xMC0wLTIt\n" + "## MTYxMB4XDTI1MDkzMDEzMjc1NVoXDTM1MDkyOTEzMjc1NVowPzE9MDsGA1UEAww0\n" + "## T3BlblZQTiBXZWIgQ0EgMjAyNS4xMC4wMSAxMzoyNzo1NSBVVEMgaXAtMTAtMC0y\n" + "## LTE2MTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMEr6tcWf3BmYc8Q\n" + "## hDWtb52tzktV8Enabb7JlatRhR2nu+4Ad782Uq5c87rjNE/OJKDIber4NoutCXoA\n" + "## jeSwBNtIV6/badwqhKteSACXVF7m9git6oh6zFvwmO4rPH/DGWvFbLjn7hMn3am6\n" + "## +PvUrKlUJ8CDd3XKC3Cf1GRaqHsCZMIxTK/ILJkibHZt6qYxIIzrVU/5jYRzMI65\n" + "## DVzM95EvANaRaK89bs7CFsgIlP26ElIo21RhS12Ogkch+aXsa09WlBATV+pX9T7i\n" + "## pmaO+RbHWdNdJhpAqF0xwWWa7BOkJLruiCpYA706HmcwDMhc9JpTCbFnpW20FQVq\n" + "## DqECOOUCAwEAAaMgMB4wDwYDVR0TAQH/BAUwAwEB/zALBgNVHQ8EBAMCAQYwDQYJ\n" + "## KoZIhvcNAQELBQADggEBAB1ucsL+0g+tK6odvAPuVbPPuPlLWYWR1V/HlnGn6K0N\n" + "## Db4ri5p57tYbW+4zT2F8LkIKt/fmVKZfIJoKt4octEGUPzDLyEB654cli2iW4G8O\n" + "## b6UVGZbObjAqGLHXK39/ovSPYlxI3gff7919iU+kq+tm1NAu3Oq3yXCd/iJAVqel\n" + "## mrEIAkGsS4Yq6XVvv+nhWpxf/H6QV5TWwp408h47mr7/o/Mum3pDiy93HSHBauf3\n" + "## gcD2rKwSGcrygQH4xHRGFjNUa1wG3/axX4SLy5McfaunkqICw5k0/IoA25/M4QOW\n" + "## 1a+zXnChn94/8O/Zzag1eBYtP8Jf4F/2bAqplHlVGCc=\n" + "## -----END CERTIFICATE-----\n"
        )
    }

    fun disconnectVpn() {
        viewModelScope.launch(Dispatchers.IO) {
            vpnRepository.disconnectVpn()
        }
    }
}